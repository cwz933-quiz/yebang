<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>77íšŒ ì•½ì‚¬êµ­ì‹œ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .quiz-container { background-color: white; width: 100%; max-width: 600px; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); position: relative; }
        
        /* ë©”ì¸ìœ¼ë¡œ ê°€ê¸° ë²„íŠ¼ */
        .home-btn { display: inline-block; text-decoration: none; color: #666; font-size: 14px; margin-bottom: 20px; padding: 8px 12px; background-color: #f1f3f5; border-radius: 20px; transition: all 0.2s; font-weight: bold; }
        .home-btn:hover { background-color: #e9ecef; color: #333; }

        h1 { font-size: 20px; color: #333; text-align: center; margin-bottom: 20px; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; margin-top: 0; }
        .progress { text-align: right; font-size: 14px; color: #666; margin-bottom: 10px; }
        .question { font-size: 18px; font-weight: bold; margin-bottom: 20px; line-height: 1.5; }
        
        /* ê°ê´€ì‹ ë³´ê¸° ìŠ¤íƒ€ì¼ */
        .options { list-style: none; padding: 0; }
        .options li { margin-bottom: 10px; }
        .options button { width: 100%; padding: 12px; font-size: 16px; text-align: left; background-color: #fff; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .options button:hover { background-color: #e8f5e9; }
        .options button.correct { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
        .options button.wrong { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }

        /* ì£¼ê´€ì‹ ì…ë ¥ ìŠ¤íƒ€ì¼ */
        .input-container { display: flex; gap: 10px; margin-bottom: 10px; }
        .input-answer { flex: 1; padding: 12px; font-size: 16px; border: 2px solid #ddd; border-radius: 8px; outline: none; transition: border 0.3s; }
        .input-answer:focus { border-color: #4CAF50; }
        .submit-btn { padding: 12px 20px; background-color: #2196F3; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .submit-btn:hover { background-color: #1976D2; }
        .submit-btn:disabled { background-color: #ccc; cursor: not-allowed; }

        .feedback { margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; font-size: 15px; color: #333; display: none; line-height: 1.6; }
        .feedback strong { color: #d9534f; }
        
        .btn-container { display: flex; gap: 10px; margin-top: 20px; }
        .nav-btn { flex: 1; padding: 15px; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; display: none; }
        .prev-btn { background-color: #6c757d; color: white; }
        .next-btn { background-color: #4CAF50; color: white; }
        
        .result-screen { text-align: center; display: none; }
        .score { font-size: 40px; font-weight: bold; color: #4CAF50; margin: 20px 0; }
    </style>
</head>
<body>

<div class="quiz-container">
    <a href="index.html" class="home-btn">ğŸ  ë©”ì¸ ë©”ë‰´ë¡œ</a>

    <div id="quiz-box">
        <h1>ğŸ’Š ì˜ˆë°©ì•½í•™ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬</h1>
        <div class="progress" id="progress">ë¬¸ì œ 1 / 30</div>
        <div class="question" id="question-text">ë¬¸ì œ ë¡œë”©ì¤‘...</div>
        
        <ul class="options" id="options-list"></ul>
        
        <div class="input-container" id="input-area" style="display:none;">
            <input type="text" class="input-answer" id="text-input" placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”">
            <button class="submit-btn" id="submit-answer-btn" onclick="checkTextAnswer()">í™•ì¸</button>
        </div>

        <div class="feedback" id="feedback"></div>
        
        <div class="btn-container">
            <button class="nav-btn prev-btn" id="prev-btn" onclick="prevQuestion()">â¬…ï¸ ì´ì „ ë¬¸ì œ</button>
            <button class="nav-btn next-btn" id="next-btn" onclick="nextQuestion()">ë‹¤ìŒ ë¬¸ì œ â¡ï¸</button>
        </div>
    </div>

    <div class="result-screen" id="result-screen">
        <h1>ìˆ˜ê³ í–ˆìŠµë‹ˆë‹¤! ìë„¤ì˜ ì ìˆ˜ëŠ”?</h1>
        <div class="score" id="final-score"></div>
        <p id="score-message"></p>
        <div class="btn-container">
            <button class="nav-btn next-btn" style="display:block; background-color:#666;" onclick="location.href='index.html'">ë©”ì¸ìœ¼ë¡œ</button>
            <button class="nav-btn next-btn" style="display:block" onclick="location.reload()">ë‹¤ì‹œ í’€ê¸°</button>
        </div>
    </div>
</div>

<script>
    // ğŸ’¡ [ë¬¸ì œ ë°ì´í„° ì‘ì„±ë²•]
    // 1. ê°ê´€ì‹: ê¸°ì¡´ê³¼ ë™ì¼ (type ìƒëµ ê°€ëŠ¥ ë˜ëŠ” "choice")
    // 2. ì£¼ê´€ì‹: type: "text" ì¶”ê°€, a: "ì •ë‹µë¬¸ìì—´" (ë³´ê¸° ë°°ì—´ ì•„ë‹˜!)
    
    const quizData = [
        // â–¼ [ê°ê´€ì‹ ì˜ˆì‹œ]
        { 
            type: "choice",
            q: "1. ë‹¤ìŒ ì¤‘ AhRê³¼ ê²°í•©í•˜ì—¬ CYP1A ìœ ë„ë¥¼ ì¼ìœ¼í‚¤ëŠ” ë¬¼ì§ˆì€?", 
            a: ["Rifampin", "Ethanol", "Phenobarbital", "PCB, TCDD", "Clofibrate"], 
            c: 3, 
            expl: "CYP1A ìœ ë„ë¬¼ì§ˆì€ PCB, TCDD ë“±ì…ë‹ˆë‹¤." 
        },
        // â–¼ [ì£¼ê´€ì‹ ì˜ˆì‹œ] type: "text"
        { 
            type: "text",
            q: "2. PXRì„ ë§¤ê°œë¡œ CYP3A4 íš¨ì†Œë¥¼ ê°•ë ¥í•˜ê²Œ ìœ ë„í•˜ëŠ” ê²°í•µ ì¹˜ë£Œì œëŠ” ë¬´ì—‡ì¸ê°€? (ì˜ë¬¸ ì„±ë¶„ëª…)", 
            a: "Rifampin", // ì •ë‹µ ë‹¨ì–´
            expl: "Rifampinì€ ê°•ë ¥í•œ CYP3A4 ìœ ë„ì œì…ë‹ˆë‹¤." 
        },
        { 
            type: "text",
            q: "3. Isoniazid ëŒ€ì‚¬ì— ê´€ì—¬í•˜ë©°, í™œì„±ì´ ëŠë¦° ê²½ìš°(Slow acetylator) ë§ì´ˆì‹ ê²½ì—¼ì„ ìœ ë°œí•˜ëŠ” íš¨ì†Œì˜ ì•½ì–´ëŠ”?", 
            a: "NAT2", 
            expl: "NAT2(N-acetyltransferase 2)ì˜ ë‹¤í˜•ì„±ì— ë”°ë¼ ë…ì„±ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤." 
        },
        // ... ì—¬ê¸°ì— ê³„ì† ì¶”ê°€ ...
        {
             q: "4. ì‹ ìƒì•„ì—ì„œ UGT í™œì„±ì´ ë‚®ì•„ Chloramphenicol íˆ¬ì—¬ ì‹œ ë°œìƒí•˜ëŠ” ë…ì„±ì€?", 
             a: ["í•µí™©ë‹¬", "Gray baby syndrome", "ìš©í˜ˆì„± ë¹ˆí˜ˆ", "ë©”íŠ¸í—¤ëª¨ê¸€ë¡œë¹ˆí˜ˆì¦", "ë‹´ì¦™ ì •ì²´"], 
             c: 1, 
             expl: "ì‹ ìƒì•„ëŠ” UGT1A1 í™œì„±ì´ ë‚®ì•„ Gray baby syndromeì´ ë°œìƒí•©ë‹ˆë‹¤." 
        }
    ];

    let currentQuestion = 0;
    // ì‚¬ìš©ì ë‹µì•ˆ ì €ì¥ (ê°ê´€ì‹ì€ index, ì£¼ê´€ì‹ì€ ì…ë ¥í•œ ë¬¸ìì—´)
    let userAnswers = new Array(quizData.length).fill(null);
    // ì£¼ê´€ì‹ ì •ë‹µ ì—¬ë¶€ ì €ì¥ (true/false)
    let textCorrectness = new Array(quizData.length).fill(null);

    const questionText = document.getElementById("question-text");
    const optionsList = document.getElementById("options-list");
    const inputArea = document.getElementById("input-area");
    const textInput = document.getElementById("text-input");
    const submitBtn = document.getElementById("submit-answer-btn");
    
    const feedback = document.getElementById("feedback");
    const nextBtn = document.getElementById("next-btn");
    const prevBtn = document.getElementById("prev-btn");
    const progress = document.getElementById("progress");
    const quizBox = document.getElementById("quiz-box");
    const resultScreen = document.getElementById("result-screen");
    const finalScore = document.getElementById("final-score");
    const scoreMessage = document.getElementById("score-message");

    // ì—”í„°í‚¤ ì…ë ¥ ì‹œ ì •ë‹µ í™•ì¸
    textInput.addEventListener("keydown", function(event) {
        if (event.key === "Enter" && !submitBtn.disabled) {
            checkTextAnswer();
        }
    });

    function loadQuestion() {
        const q = quizData[currentQuestion];
        questionText.innerText = q.q;
        optionsList.innerHTML = "";
        feedback.style.display = "none";
        progress.innerText = `ë¬¸ì œ ${currentQuestion + 1} / ${quizData.length}`;
        
        // ì´ì „ ë²„íŠ¼ ê´€ë¦¬
        prevBtn.style.display = (currentQuestion === 0) ? "none" : "block";

        // ë¬¸ì œ íƒ€ì… í™•ì¸ (ê¸°ë³¸ê°’ì€ choice)
        const qType = q.type || "choice";

        if (qType === "text") {
            // [ì£¼ê´€ì‹ ëª¨ë“œ]
            optionsList.style.display = "none";
            inputArea.style.display = "flex";
            
            // ì´ë¯¸ í‘¼ ê²½ìš° ê¸°ë¡ ë³µì›
            if (userAnswers[currentQuestion] !== null) {
                textInput.value = userAnswers[currentQuestion];
                textInput.disabled = true;
                submitBtn.disabled = true;
                showFeedbackText(textCorrectness[currentQuestion]);
            } else {
                textInput.value = "";
                textInput.disabled = false;
                submitBtn.disabled = false;
                nextBtn.style.display = "none";
                textInput.focus();
            }

        } else {
            // [ê°ê´€ì‹ ëª¨ë“œ]
            optionsList.style.display = "block";
            inputArea.style.display = "none";
            
            const answeredIndex = userAnswers[currentQuestion];
            const isAnswered = answeredIndex !== null;

            if (isAnswered) {
                showFeedbackChoice(answeredIndex);
            } else {
                nextBtn.style.display = "none";
            }

            q.a.forEach((option, index) => {
                const li = document.createElement("li");
                const btn = document.createElement("button");
                btn.innerText = option;
                
                if (isAnswered) {
                    btn.disabled = true;
                    if (index === q.c) btn.classList.add("correct");
                    else if (index === answeredIndex && index !== q.c) btn.classList.add("wrong");
                } else {
                    btn.onclick = () => checkChoiceAnswer(index, btn);
                }
                li.appendChild(btn);
                optionsList.appendChild(li);
            });
        }
    }

    // ê°ê´€ì‹ ì •ë‹µ ì²´í¬
    function checkChoiceAnswer(selectedIndex, btn) {
        userAnswers[currentQuestion] = selectedIndex;
        showFeedbackChoice(selectedIndex);
    }

    // ê°ê´€ì‹ í”¼ë“œë°± í‘œì‹œ
    function showFeedbackChoice(selectedIndex) {
        const q = quizData[currentQuestion];
        const buttons = optionsList.querySelectorAll("button");
        buttons.forEach(b => b.disabled = true);

        // í˜„ì¬ í™”ë©´ì˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (ë²„íŠ¼ì´ ì¡´ì¬í•  ë•Œë§Œ)
        if (buttons.length > 0) {
            if (selectedIndex === q.c) {
                buttons[selectedIndex].classList.add("correct");
                feedback.innerHTML = `<strong>ì •ë‹µì…ë‹ˆë‹¤! ğŸ™†â€â™‚ï¸</strong><br>${q.expl}`;
            } else {
                buttons[selectedIndex].classList.add("wrong");
                buttons[q.c].classList.add("correct");
                feedback.innerHTML = `<strong>ì˜¤ë‹µì…ë‹ˆë‹¤ ğŸ™…â€â™‚ï¸</strong><br>ì •ë‹µì€ <strong>${q.a[q.c]}</strong> ì…ë‹ˆë‹¤.<br>${q.expl}`;
            }
        }
        
        feedback.style.display = "block";
        nextBtn.style.display = "block";
        updateNextBtnText();
    }

    // ì£¼ê´€ì‹ ì •ë‹µ ì²´í¬
    function checkTextAnswer() {
        const userVal = textInput.value.trim();
        if (!userVal) return; // ë¹ˆì¹¸ì´ë©´ ë°˜ì‘ X

        userAnswers[currentQuestion] = userVal;
        
        const q = quizData[currentQuestion];
        // ì •ë‹µ ë¹„êµ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ, ê³µë°± ì œê±° í›„ ë¹„êµ)
        const cleanUser = userVal.toLowerCase().replace(/\s/g, "");
        const cleanAns = q.a.toLowerCase().replace(/\s/g, "");

        const isCorrect = (cleanUser === cleanAns);
        textCorrectness[currentQuestion] = isCorrect;

        textInput.disabled = true;
        submitBtn.disabled = true;

        showFeedbackText(isCorrect);
    }

    // ì£¼ê´€ì‹ í”¼ë“œë°± í‘œì‹œ
    function showFeedbackText(isCorrect) {
        const q = quizData[currentQuestion];
        if (isCorrect) {
            textInput.style.borderColor = "#4CAF50"; // ì´ˆë¡ í…Œë‘ë¦¬
            feedback.innerHTML = `<strong>ì •ë‹µì…ë‹ˆë‹¤! ğŸ™†â€â™‚ï¸</strong><br>${q.expl}`;
        } else {
            textInput.style.borderColor = "#f44336"; // ë¹¨ê°• í…Œë‘ë¦¬
            feedback.innerHTML = `<strong>ì˜¤ë‹µì…ë‹ˆë‹¤ ğŸ™…â€â™‚ï¸</strong><br>ì •ë‹µì€ <strong>${q.a}</strong> ì…ë‹ˆë‹¤.<br>${q.expl}`;
        }
        feedback.style.display = "block";
        nextBtn.style.display = "block";
        updateNextBtnText();
    }

    function updateNextBtnText() {
        if (currentQuestion === quizData.length - 1) {
            nextBtn.innerText = "ê²°ê³¼ ë³´ê¸°";
        } else {
            nextBtn.innerText = "ë‹¤ìŒ ë¬¸ì œ â¡ï¸";
        }
    }

    function prevQuestion() {
        if (currentQuestion > 0) {
            currentQuestion--;
            loadQuestion();
        }
    }

    function nextQuestion() {
        currentQuestion++;
        if (currentQuestion < quizData.length) {
            loadQuestion();
        } else {
            showResult();
        }
    }

    function showResult() {
        let finalScoreValue = 0;
        for (let i = 0; i < quizData.length; i++) {
            const q = quizData[i];
            const qType = q.type || "choice";

            if (qType === "text") {
                if (textCorrectness[i]) finalScoreValue++;
            } else {
                if (userAnswers[i] === q.c) finalScoreValue++;
            }
        }

        quizBox.style.display = "none";
        resultScreen.style.display = "block";
        finalScore.innerText = `${finalScoreValue} / ${quizData.length}ì `;
        
        if (finalScoreValue >= quizData.length * 0.8) {
            scoreMessage.innerText = "ëŒ€ë‹¨í•˜ë„¤! ì£¼ê´€ì‹ê¹Œì§€ ì™„ë²½í•´!";
        } else {
            scoreMessage.innerText = "ì¡°ê¸ˆ ë” ë¶„ë°œí•˜ê²Œ. ì“°ëŠ” ì—°ìŠµì´ ë” í•„ìš”í•´ ë³´ì—¬.";
        }
    }

    loadQuestion();
</script>

</body>
</html>
